---

title: TabNet for fastai

keywords: fastai
sidebar: home_sidebar

summary: "This is an adaptation of TabNet (Attention-based network for tabular data) for fastai (>=2.0) library. The original paper https://arxiv.org/pdf/1908.07442.pdf. The implementation is taken from here https://github.com/dreamquark-ai/tabnet"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install fast_tabnet</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>model = TabNetModel(emb_szs, n_cont, out_sz, embed_p=0., y_range=None, 
                     n_d=8, n_a=8,
                     n_steps=3, gamma=1.3, 
                     n_independent=2, n_shared=2, epsilon=1e-15,
                     virtual_batch_size=128, momentum=0.02)</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Parameters <code>emb_szs, n_cont, out_sz, embed_p, y_range</code> are the same as for fastai TabularModel.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>n_d : int
  Dimension of the prediction  layer (usually between 4 and 64)</li>
<li>n_a : int
  Dimension of the attention  layer (usually between 4 and 64)</li>
<li>n_steps: int
  Number of sucessive steps in the newtork (usually betwenn 3 and 10)</li>
<li>gamma : float
  Float above 1, scaling factor for attention updates (usually betwenn 1.0 to 2.0)</li>
<li>momentum : float
  Float value between 0 and 1 which will be used for momentum in all batch norm</li>
<li>n_independent : int
  Number of independent GLU layer in each GLU block (default 2)</li>
<li>n_shared : int
  Number of independent GLU layer in each GLU block (default 2)</li>
<li>epsilon: float
  Avoid log(0), this should be kept very low</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example">Example<a class="anchor-link" href="#Example">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below is an example from fastai library, but the model in use is TabNet</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai2.basics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2.tabular.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fast_tabnet.core</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ADULT_SAMPLE</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;adult.csv&#39;</span><span class="p">)</span>
<span class="n">df_main</span><span class="p">,</span><span class="n">df_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10000</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">10000</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_main</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49</td>
      <td>Private</td>
      <td>101320</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>NaN</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Private</td>
      <td>236746</td>
      <td>Masters</td>
      <td>14.0</td>
      <td>Divorced</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>10520</td>
      <td>0</td>
      <td>45</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>96185</td>
      <td>HS-grad</td>
      <td>NaN</td>
      <td>Divorced</td>
      <td>NaN</td>
      <td>Unmarried</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>32</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>Self-emp-inc</td>
      <td>112847</td>
      <td>Prof-school</td>
      <td>15.0</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>Asian-Pac-Islander</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>Self-emp-not-inc</td>
      <td>82297</td>
      <td>7th-8th</td>
      <td>NaN</td>
      <td>Married-civ-spouse</td>
      <td>Other-service</td>
      <td>Wife</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">]</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">]</span>
<span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">]</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">()(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df_main</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df_main</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="o">=</span><span class="s2">&quot;salary&quot;</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dbch</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">()</span>
<span class="n">dbch</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>age_na</th>
      <th>fnlwgt_na</th>
      <th>education-num_na</th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Local-gov</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Craft-repair</td>
      <td>Husband</td>
      <td>Black</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>45.000000</td>
      <td>556652.007499</td>
      <td>9.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Private</td>
      <td>Bachelors</td>
      <td>Never-married</td>
      <td>Sales</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>29.000000</td>
      <td>176683.000072</td>
      <td>13.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Private</td>
      <td>Bachelors</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>29.000000</td>
      <td>194939.999936</td>
      <td>13.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Transport-moving</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>29.000000</td>
      <td>52635.998841</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>State-gov</td>
      <td>Some-college</td>
      <td>Married-civ-spouse</td>
      <td>Machine-op-inspct</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>49.000000</td>
      <td>122177.000557</td>
      <td>10.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Private</td>
      <td>12th</td>
      <td>Married-civ-spouse</td>
      <td>Machine-op-inspct</td>
      <td>Other-relative</td>
      <td>Other</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>28.000000</td>
      <td>158737.000048</td>
      <td>8.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Machine-op-inspct</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>55.999999</td>
      <td>192868.999992</td>
      <td>9.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Self-emp-not-inc</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Craft-repair</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>56.999999</td>
      <td>65080.002276</td>
      <td>9.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Local-gov</td>
      <td>Masters</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>50.000000</td>
      <td>145165.999578</td>
      <td>10.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Private</td>
      <td>Assoc-voc</td>
      <td>Never-married</td>
      <td>Tech-support</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>35.000000</td>
      <td>186034.999925</td>
      <td>11.0</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to_tst</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
<span class="n">to_tst</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
<span class="n">to_tst</span><span class="o">.</span><span class="n">all_cols</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>age_na</th>
      <th>fnlwgt_na</th>
      <th>education-num_na</th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10000</th>
      <td>5</td>
      <td>10</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.456238</td>
      <td>1.346622</td>
      <td>1.164335</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10001</th>
      <td>5</td>
      <td>12</td>
      <td>3</td>
      <td>15</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-0.930752</td>
      <td>1.259253</td>
      <td>-0.419996</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10002</th>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>9</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.040233</td>
      <td>0.152193</td>
      <td>-1.212162</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10003</th>
      <td>5</td>
      <td>12</td>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.529237</td>
      <td>-0.282632</td>
      <td>-0.419996</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10004</th>
      <td>6</td>
      <td>9</td>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.748235</td>
      <td>1.449564</td>
      <td>0.372169</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">to</span><span class="p">);</span> <span class="nb">print</span><span class="p">(</span><span class="n">emb_szs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(10, 6), (17, 8), (8, 5), (16, 8), (7, 5), (6, 4), (2, 2), (2, 2), (3, 3)]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's the use of the model</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">TabNetModel</span><span class="p">(</span><span class="n">emb_szs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">cont_names</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_d</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">n_a</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dbch</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">MSELossFlat</span><span class="p">(),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">3e-2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.161420</td>
      <td>0.163181</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.140478</td>
      <td>0.127033</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.132842</td>
      <td>0.117864</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.126220</td>
      <td>0.115803</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.125338</td>
      <td>0.117127</td>
      <td>0.757500</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.123562</td>
      <td>0.119050</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.121530</td>
      <td>0.117025</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.116976</td>
      <td>0.114524</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.113542</td>
      <td>0.114590</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.111071</td>
      <td>0.114707</td>
      <td>0.757500</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-with-Bayesian-Optimization">Example with Bayesian Optimization<a class="anchor-link" href="#Example-with-Bayesian-Optimization">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I like to tune hyperparameters for tabular models with Bayesian Optimization. You can optimize directly your metric using this approach if the metric is sensitive enough (in our example it is not and we use validation loss instead). Also, you should create the second validation set, because you will use the first as a training set for Bayesian Optimization.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You may need to install the optimizer <code>pip install bayesian-optimization</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The function we&#39;ll optimize</span>
<span class="nd">@lru_cache</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_accuracy</span><span class="p">(</span><span class="n">n_d</span><span class="p">:</span><span class="n">Int</span><span class="p">,</span> <span class="n">n_a</span><span class="p">:</span><span class="n">Int</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">:</span><span class="n">Int</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">TabNetModel</span><span class="p">(</span><span class="n">emb_szs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">cont_names</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_d</span><span class="o">=</span><span class="n">n_d</span><span class="p">,</span> <span class="n">n_a</span><span class="o">=</span><span class="n">n_a</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="n">n_steps</span><span class="p">);</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dbch</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">MSELossFlat</span><span class="p">(),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">3e-2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">])</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">valid</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This implementation of Bayesian Optimization doesn't work naturally with descreet values. That's why we use wrapper with <code>lru_cache</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fit_accuracy</span><span class="p">(</span><span class="n">pow_n_d</span><span class="p">,</span> <span class="n">pow_n_a</span><span class="p">,</span> <span class="n">pow_n_steps</span><span class="p">):</span>
    <span class="n">pow_n_d</span><span class="p">,</span> <span class="n">pow_n_a</span><span class="p">,</span> <span class="n">pow_n_steps</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">(</span><span class="n">pow_n_d</span><span class="p">,</span> <span class="n">pow_n_a</span><span class="p">,</span> <span class="n">pow_n_steps</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">get_accuracy</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">pow_n_d</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">pow_n_a</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">pow_n_steps</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">bayes_opt</span> <span class="kn">import</span> <span class="n">BayesianOptimization</span>

<span class="c1"># Bounded region of parameter space</span>
<span class="n">pbounds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pow_n_d&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;pow_n_a&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;pow_n_steps&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)}</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">BayesianOptimization</span><span class="p">(</span>
    <span class="n">f</span><span class="o">=</span><span class="n">fit_accuracy</span><span class="p">,</span>
    <span class="n">pbounds</span><span class="o">=</span><span class="n">pbounds</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span><span class="o">.</span><span class="n">maximize</span><span class="p">(</span>
    <span class="n">init_points</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span><span class="o">.</span><span class="n">max</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;target&#39;: -0.11365877091884613,
 &#39;params&#39;: {&#39;pow_n_a&#39;: 8.0, &#39;pow_n_d&#39;: 1.0475135442460393, &#39;pow_n_steps&#39;: 0.0}}</pre>
</div>

</div>

</div>
</div>

</div>
</div>
 

